#!/usr/bin/env python3
"""
–¢–µ—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ —Ñ–ª–∞–≥–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö
"""

import asyncio
from rich.console import Console
from rich.table import Table

console = Console()

async def test_interrupt_flag_reset():
    """–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö"""
    console.print("üöÄ –¢–µ—Å—Ç —Å–±—Ä–æ—Å–∞ —Ñ–ª–∞–≥–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    console.print("=" * 60)
    
    # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
    table = Table(title="üìä –°—Ü–µ–Ω–∞—Ä–∏–∏ —Å–±—Ä–æ—Å–∞ —Ñ–ª–∞–≥–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    table.add_column("–°—Ü–µ–Ω–∞—Ä–∏–π", style="cyan")
    table.add_column("–ú–µ—Ç–æ–¥", style="yellow")
    table.add_column("–ö–æ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è", style="green")
    
    scenarios = [
        ("–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ (LISTENING)", "handle_interrupt_or_cancel", "–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ SLEEPING"),
        ("–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã (IN_PROCESS)", "handle_interrupt_or_cancel", "–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ SLEEPING"),
        ("–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –≤ SLEEPING", "handle_interrupt_or_cancel", "–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è)"),
        ("–§–æ–Ω–æ–≤–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ", "_interrupt_background", "–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è"),
        ("–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ", "_force_interrupt_all", "–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π"),
        ("–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ + –∞–∫—Ç–∏–≤–∞—Ü–∏—è", "handle_start_recording", "–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ LISTENING"),
        ("–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ", "handle_interrupt_or_cancel", "–ü–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ SLEEPING"),
    ]
    
    for scenario, method, when in scenarios:
        table.add_row(scenario, method, when)
    
    console.print(table)
    
    console.print("\nüéØ –ü—Ä–æ–±–ª–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—Å–ø—Ä–∞–≤–∏–ª–∏:")
    console.print("  ‚ùå –§–ª–∞–≥ interrupting –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–ª—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    console.print("  ‚ùå –ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –º–æ–≥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –Ω–∞–∂–∞—Ç–∏–∏")
    console.print("  ‚ùå –°–∏—Å—Ç–µ–º–∞ '–∑–∞–≤–∏—Å–∞–ª–∞' –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    
    console.print("\n‚úÖ –†–µ—à–µ–Ω–∏–µ:")
    console.print("  ‚Ä¢ –î–æ–±–∞–≤–∏–ª–∏ —Å–±—Ä–æ—Å —Ñ–ª–∞–≥–∞ –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    console.print("  ‚Ä¢ –§–ª–∞–≥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    console.print("  ‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ä–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ")
    
    console.print("\nüîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:")
    console.print("  ‚Ä¢ _force_interrupt_all: —Å–±—Ä–æ—Å –ø–æ—Å–ª–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    console.print("  ‚Ä¢ _interrupt_background: —Å–±—Ä–æ—Å –ø–æ—Å–ª–µ —Ñ–æ–Ω–æ–≤–æ–≥–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è")
    console.print("  ‚Ä¢ handle_interrupt_or_cancel: —Å–±—Ä–æ—Å –¥–ª—è LISTENING –∏ IN_PROCESS")
    console.print("  ‚Ä¢ handle_start_recording: —Å–±—Ä–æ—Å –ø–æ—Å–ª–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è IN_PROCESS")
    
    console.print("\nüì± –¢–µ–ø–µ—Ä—å –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫:")
    console.print("  1. –ü—Ä–æ–±–µ–ª –Ω–∞–∂–∞—Ç ‚Üí interrupting = True")
    console.print("  2. –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è")
    console.print("  3. –§–ª–∞–≥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è ‚Üí interrupting = False")
    console.print("  4. –ú–∏–∫—Ä–æ—Ñ–æ–Ω –º–æ–∂–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –Ω–∞–∂–∞—Ç–∏–∏")

if __name__ == "__main__":
    try:
        asyncio.run(test_interrupt_flag_reset())
    except KeyboardInterrupt:
        console.print("\nüëã –í—ã—Ö–æ–¥...")
    except Exception as e:
        console.print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
