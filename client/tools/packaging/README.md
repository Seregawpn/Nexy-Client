# üì¶ Nexy Packaging Directory

## üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
packaging/
‚îú‚îÄ‚îÄ Nexy.spec                    # PyInstaller –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Sparkle
‚îú‚îÄ‚îÄ entitlements.plist           # macOS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–±–µ–∑ debugger, —Ä–µ–ª–∏–∑–Ω–∞—è –≤–µ—Ä—Å–∏—è)
‚îú‚îÄ‚îÄ build_pkg.sh                 # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ PKG (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
‚îú‚îÄ‚îÄ generate_sparkle_keys.sh     # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Ed25519 –∫–ª—é—á–µ–π
‚îú‚îÄ‚îÄ sign_appcast.sh              # –ü–æ–¥–ø–∏—Å—å appcast.xml
‚îú‚îÄ‚îÄ Makefile                     # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ README.md                    # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Sparkle.framework/           # Sparkle Framework –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îú‚îÄ‚îÄ sparkle_keys/                # Ed25519 –∫–ª—é—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ ed25519_private_key.pem  # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (—Ö—Ä–∞–Ω–∏—Ç—å –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!)
‚îÇ   ‚îî‚îÄ‚îÄ ed25519_public_key.pem   # –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (–≤—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
‚îî‚îÄ‚îÄ local_server/                # –õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    ‚îú‚îÄ‚îÄ start_server.py          # HTTP —Å–µ—Ä–≤–µ—Ä
    ‚îú‚îÄ‚îÄ README.md                # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —Å–µ—Ä–≤–µ—Ä—É
    ‚îî‚îÄ‚îÄ updates/                 # –§–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
        ‚îú‚îÄ‚îÄ appcast.xml          # XML —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è—Ö
        ‚îî‚îÄ‚îÄ Nexy-with-Sparkle-2.5.0-signed.pkg  # –¢–µ—Å—Ç–æ–≤—ã–π PKG
```

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (v2.0)

### –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:
- **‚úÖ Sparkle Framework:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `Tree()` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ `Contents/Frameworks`
- **‚úÖ Info.plist:** –î–æ–±–∞–≤–ª–µ–Ω—ã `SUPublicEDKey` –∏ `SUFeedURL` –¥–ª—è —Ä–∞–±–æ—Ç—ã Sparkle
- **‚úÖ Entitlements:** –£–¥–∞–ª–µ–Ω `com.apple.security.cs.debugger` –¥–ª—è —Ä–µ–ª–∏–∑–Ω–æ–π –≤–µ—Ä—Å–∏–∏
- **‚úÖ –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏ PyInstaller –∏ codesign

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Nexy.spec:
```python
# –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Sparkle
Tree(SPARKLE_FRAMEWORK, prefix='Frameworks/Sparkle.framework'),

# –í Info.plist
'SUPublicEDKey': SU_PUBLIC_ED_KEY,
'SUFeedURL': FEED_URL,
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –°–±–æ—Ä–∫–∞ PKG (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
./build_pkg.sh

# 2. –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
python3 local_server/start_server.py
```

## üîë –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á** (`sparkle_keys/ed25519_private_key.pem`) - —Ö—Ä–∞–Ω–∏—Ç–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏!
- **–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á** —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **–ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏** –≤ git!

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç build_pkg.sh

1. ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç .app —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å—å—é PyInstaller
2. ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç Sparkle Framework —á–µ—Ä–µ–∑ Tree()
3. ‚úÖ –û—á–∏—â–∞–µ—Ç extended attributes
4. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å .app
5. ‚úÖ –°–æ–∑–¥–∞–µ—Ç PKG installer
6. ‚úÖ –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç PKG
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å PKG

## üåê –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

```bash
# –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
python3 local_server/start_server.py

# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å: http://localhost:8080/updates/appcast.xml
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- **–ù–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .app –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏** - —ç—Ç–æ —Å–ª–æ–º–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å
- **–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ .spec —Ñ–∞–π–ª–µ**
- **–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ appcast**
- **PKG —Ñ–∞–π–ª—ã –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä**

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Å–±–æ—Ä–∫–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ .app –±–µ–∑ PKG:

```bash
cd /Users/sergiyzasorin/Desktop/Development/Nexy/client
python3 -m PyInstaller --clean -y tools/packaging/Nexy.spec

# –û—á–∏—Å—Ç–∫–∞ extended attributes
xattr -rc dist/Nexy.app

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
codesign --verify --deep --strict --verbose=2 dist/Nexy.app
```


