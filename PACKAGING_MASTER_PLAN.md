# üì¶ –ú–ê–°–¢–ï–†-–ü–õ–ê–ù –£–ü–ê–ö–û–í–ö–ò NEXY AI ASSISTANT

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-09
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-10-10
**–í–µ—Ä—Å–∏—è:** 2.0 (–ó–ê–í–ï–†–®–Å–ù)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –≠–¢–ê–ü–´ –í–´–ü–û–õ–ù–ï–ù–´ –£–°–ü–ï–®–ù–û
**–¶–µ–ª—å:** –£–ø–∞–∫–æ–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Nexy –≤ .app bundle –¥–ª—è macOS (M1+) —á–µ—Ä–µ–∑ PyInstaller

---

## üéâ –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### –£–ø–∞–∫–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!

**–§–∏–Ω–∞–ª—å–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã:**
- ‚úÖ `dist/Nexy.app` - –ø–æ–¥–ø–∏—Å–∞–Ω, –Ω–æ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω, —Ä–∞–∑–º–µ—Ä ~200MB
- ‚úÖ `dist/Nexy.dmg` - –ø–æ–¥–ø–∏—Å–∞–Ω, –Ω–æ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω, stapled, 93MB
- ‚úÖ `dist/Nexy.pkg` - –ø–æ–¥–ø–∏—Å–∞–Ω, –Ω–æ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω, stapled, 93MB

**–û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 1 –¥–µ–Ω—å (2025-10-09 ‚Üí 2025-10-10)

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã:**
1. ‚ùå ‚Üí ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª packaging/Nexy.spec (—Å–æ–∑–¥–∞–Ω —Å –Ω—É–ª—è)
2. ‚ùå ‚Üí ‚úÖ –£—Å—Ç–∞—Ä–µ–≤—à–∏–π FLAC x86_64 SDK 10.6 (–æ–±–Ω–æ–≤–ª—ë–Ω –Ω–∞ arm64 1.5.0)
3. ‚ùå ‚Üí ‚úÖ –ü—É—Ç–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (—Å–æ–∑–¥–∞–Ω resource_path.py, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 7 —Ñ–∞–π–ª–æ–≤)
4. ‚ùå ‚Üí ‚úÖ numpy excluded (—É–¥–∞–ª—ë–Ω –∏–∑ excludes, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 11 —Ñ–∞–π–ª–∞—Ö)

---

## üéØ –û–ë–©–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø

### –†–µ–∂–∏–º —É–ø–∞–∫–æ–≤–∫–∏: **onedir (bundle)**
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ –±–µ–∑ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å menu bar –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏
- ‚úÖ –õ–µ–≥–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–∏–Ω–∞—Ä–Ω–∏–∫–æ–≤ (FFmpeg, SwitchAudioSource)
- ‚úÖ –£–¥–æ–±–Ω–∞—è –Ω–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏—è Apple

### –¶–µ–ª–µ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** arm64 (Apple Silicon M1+)
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è macOS:** 11.0 (Big Sur)
- **Python:** 3.13.7 (—Ç–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è)

### –¢–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **LSUIElement:** True (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤ menu bar, —Å–∫—Ä—ã—Ç–æ –∏–∑ Dock)
- **Background mode:** –î–∞ (—Ñ–æ–Ω–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∏–∫–æ–Ω–∫–æ–π –≤ menu bar)

---

## üìã –≠–¢–ê–ü–´ –£–ü–ê–ö–û–í–ö–ò (–í–´–ü–û–õ–ù–ï–ù–´)

### **–≠–¢–ê–ü 0: –ü–†–û–í–ï–†–ö–ê –û–ö–†–£–ñ–ï–ù–ò–Ø** ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–Å–ù 2025-10-10
**–û—Ç—á—ë—Ç:** [docs/packaging/00_ENVIRONMENT_CHECK.md](docs/packaging/00_ENVIRONMENT_CHECK.md)

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
- ‚úÖ –°–∏—Å—Ç–µ–º–∞: arm64, macOS 26.0.1 (Sequoia)
- ‚úÖ Python: 3.13.7 –≤ .venv
- ‚úÖ PyInstaller: 6.16.0
- ‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã: Developer ID Application –∏ Installer –Ω–∞–π–¥–µ–Ω—ã
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏ venv –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö (venv/ ‚Üí .venv/)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- ‚ö†Ô∏è –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—É—Ç–µ–π venv –≤ build_final.sh –∏ –¥—Ä—É–≥–∏—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö ‚Üí –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

### **–≠–¢–ê–ü 1: –ê–£–î–ò–¢ –ò –ü–û–î–ì–û–¢–û–í–ö–ê** ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–Å–ù 2025-10-10
**–û—Ç—á—ë—Ç:** [docs/packaging/01_BINARIES_AUDIT.md](docs/packaging/01_BINARIES_AUDIT.md)

#### 1.1 –ê—É–¥–∏—Ç –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ ‚úÖ

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ `resources/ffmpeg/ffmpeg` - 39MB, arm64, adhoc signed, —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ `resources/audio/SwitchAudioSource` - 55KB, arm64, adhoc signed, —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è **FLAC –≤ SpeechRecognition:** –û–±–Ω–∞—Ä—É–∂–µ–Ω —É—Å—Ç–∞—Ä–µ–≤—à–∏–π x86_64 (SDK 10.6)
  - **–†–µ—à–µ–Ω–∏–µ:** –ó–∞–º–µ–Ω—ë–Ω –Ω–∞ FLAC 1.5.0 arm64 –∏–∑ ~/Downloads/
  - **–ù–æ–≤—ã–π –ø—É—Ç—å:** resources/audio/flac (452KB, arm64)
  - **Spec:** –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Å—Ç–∞—Ä–æ–≥–æ flac-mac
- ‚ùå **–ö–†–ò–¢–ò–ß–ù–û:** packaging/Nexy.spec –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚Üí –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å—é —É–ø–∞–∫–æ–≤–∫—É

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
file resources/ffmpeg/ffmpeg
file resources/audio/SwitchAudioSource

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤
ls -la resources/ffmpeg/ffmpeg
ls -la resources/audio/SwitchAudioSource

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
otool -L resources/ffmpeg/ffmpeg
otool -L resources/audio/SwitchAudioSource

# –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫
./resources/ffmpeg/ffmpeg -version
./resources/audio/SwitchAudioSource -a
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç `AUDIT_BINARIES.md` —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –æ—Ç—á–µ—Ç–æ–º

---

#### 1.2 –ê—É–¥–∏—Ç Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –∏ –∏—Ö —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å PyInstaller

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- [ ] requirements.txt vs —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (.venv)
- [ ] –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
  - PyObjC (11.1) - –¥–ª—è macOS API
  - rumps (0.4.0) - –¥–ª—è menu bar
  - grpcio (1.75.1) - –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
  - SpeechRecognition (3.14.3) - –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏
  - PyAudio (0.2.14) - –¥–ª—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
  - pydub (0.25.1) - –¥–ª—è –∞—É–¥–∏–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏
  - sounddevice (0.5.2) - –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
  - pynput (1.8.1) - –¥–ª—è keyboard monitoring
  - mss (10.1.0) - –¥–ª—è screenshots
  - pyinstaller (6.16.0) - –∞–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:**
- [ ] –ù–µ—Ç –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö –≤–µ—Ä—Å–∏–π –±–∏–±–ª–∏–æ—Ç–µ–∫
- [ ] –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å arm64
- [ ] –ù–µ—Ç legacy –±–∏–±–ª–∏–æ—Ç–µ–∫ (—Ç–æ–ª—å–∫–æ –¥–ª—è Intel)

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º venv
source .venv/bin/activate

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã
pip list

# –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å requirements.txt
pip freeze > installed_packages.txt
diff requirements.txt installed_packages.txt

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã
python3 -c "import rumps; print(rumps.__version__)"
python3 -c "import speech_recognition; print(speech_recognition.__version__)"
python3 -c "import grpc; print(grpc.__version__)"
python3 -c "import PyObjCTools; print('PyObjC OK')"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ FLAC –≤ SpeechRecognition
python3 -c "import speech_recognition as sr; import os; print(os.path.dirname(sr.__file__))"
ls -la .venv/lib/python3.13/site-packages/speech_recognition/
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç `AUDIT_DEPENDENCIES.md` —Å –≤–µ—Ä—Å–∏—è–º–∏ –∏ —Å—Ç–∞—Ç—É—Å–æ–º

---

#### 1.3 –ê—É–¥–∏—Ç –º–æ–¥—É–ª–µ–π –∏ –∏–º–ø–æ—Ä—Ç–æ–≤
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö import –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ circular dependencies

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –º–æ–¥—É–ª–∏:**
- [ ] **main.py** - entry point, PyObjC fix, FFmpeg init
- [ ] **integration/** - –≤—Å–µ integration –º–æ–¥—É–ª–∏ (15 —à—Ç—É–∫)
- [ ] **modules/** - –≤—Å–µ –º–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (18 —à—Ç—É–∫)
- [ ] **config/** - unified_config_loader

**–ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- [ ] –ù–µ—Ç circular imports
- [ ] –í—Å–µ relative imports –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –í—Å–µ –º–æ–¥—É–ª–∏ –∏–º–µ—é—Ç `__init__.py`
- [ ] gRPC proto –º–æ–¥—É–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ –≤ main.py
python3 -c "import sys; sys.path.insert(0, '.'); import main"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö integration –º–æ–¥—É–ª–µ–π
python3 -c "from integration.core.simple_module_coordinator import SimpleModuleCoordinator"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ gRPC proto
python3 -c "from modules.grpc_client.proto import streaming_pb2, streaming_pb2_grpc"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ rumps –∏ PyObjC
python3 -c "import rumps; import AppKit; import Foundation; print('OK')"

# –ü–æ–∏—Å–∫ circular imports
python3 -m py_compile main.py
find . -name "*.py" -path "./modules/*" -exec python3 -m py_compile {} \;
find . -name "*.py" -path "./integration/*" -exec python3 -m py_compile {} \;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç `AUDIT_MODULES.md` —Å –¥–µ—Ä–µ–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

#### 1.4 –ê—É–¥–∏—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- [ ] `config/unified_config.yaml` - –≥–ª–∞–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [ ] `config/tray_config.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç—Ä–µ—è
- [ ] –í—Å–µ –ø—É—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–∞—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

**Assets:**
- [ ] `assets/icons/app.icns` - –∏–∫–æ–Ω–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (354KB)
- [ ] `assets/icons/app_icon.icns` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –∏–∫–æ–Ω–∫–∞
- [ ] `assets/icons/active.png` - –∏–∫–æ–Ω–∫–∞ menu bar (–∞–∫—Ç–∏–≤–Ω—ã–π)
- [ ] `assets/icons/active@2x.png` - retina –≤–µ—Ä—Å–∏—è
- [ ] `assets/icons/off.png` - –∏–∫–æ–Ω–∫–∞ menu bar (–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π)
- [ ] `assets/icons/off@2x.png` - retina –≤–µ—Ä—Å–∏—è
- [ ] `assets/logo.icns` - –ª–æ–≥–æ—Ç–∏–ø

**Audio:**
- [ ] `resources/audio/welcome_en.mp3` –∏–ª–∏ `.wav` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ñ–∞–π–ª—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è

**FFmpeg:**
- [ ] `resources/ffmpeg/ffmpeg` - –±–∏–Ω–∞—Ä–Ω–∏–∫
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ main.py:19-64

**gRPC Proto:**
- [ ] `modules/grpc_client/proto/streaming_pb2.py`
- [ ] `modules/grpc_client/proto/streaming_pb2_grpc.py`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–µ–π:**
- [ ] –í—Å–µ –ø—É—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `Path` –∏–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ relative –ø—É—Ç–∏
- [ ] Resource path –ª–æ–≥–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞ –¥–ª—è PyInstaller —Ä–µ–∂–∏–º–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `get_resource_base_path()` –µ—Å–ª–∏ –µ—Å—Ç—å

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
ls -lh config/unified_config.yaml
ls -lh assets/icons/*.icns
ls -lh assets/icons/*.png
ls -lh resources/ffmpeg/ffmpeg
ls -lh resources/audio/
find modules/grpc_client/proto -name "*.py"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ YAML
python3 -c "import yaml; yaml.safe_load(open('config/unified_config.yaml'))"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∫–æ–Ω–æ–∫
file assets/icons/app.icns
file assets/icons/active.png
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç `AUDIT_RESOURCES.md` —Å –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏–µ–π

---

#### 1.5 –ê—É–¥–∏—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π macOS
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ API –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:**

| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª | API | –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | Usage Description |
|------------|-----|------------|-------------------|
| **–ú–∏–∫—Ä–æ—Ñ–æ–Ω** | PyAudio, SpeechRecognition | `NSMicrophoneUsageDescription` | –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ |
| **Keyboard** | pynput, Quartz | `NSInputMonitoringUsageDescription` + Accessibility | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–±–µ–ª–∞ |
| **Screenshot** | mss, Quartz | `NSScreenCaptureUsageDescription` | –ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞ |
| **Audio output** | sounddevice, pydub | - | –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ |
| **Menu bar** | rumps, PyObjC | `LSUIElement` | –ò–∫–æ–Ω–∫–∞ –≤ menu bar |
| **Network** | grpc | - | –°–≤—è–∑—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º |
| **Apple Events** | (–µ—Å–ª–∏ –µ—Å—Ç—å) | `NSAppleEventsUsageDescription` | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è |

**–ü—Ä–æ–≤–µ—Ä–∫–∞ entitlements.plist:**
- [ ] `com.apple.security.device.microphone` = true
- [ ] `com.apple.security.device.audio-input` = true
- [ ] `com.apple.security.cs.disable-library-validation` = true (–¥–ª—è PyInstaller)
- [ ] `com.apple.security.network.client` = true
- [ ] `com.apple.security.cs.allow-jit` = true (–¥–ª—è Python)
- [ ] `com.apple.security.cs.allow-unsigned-executable-memory` = true

**–ü—Ä–æ–≤–µ—Ä–∫–∞ Info.plist (–±—É–¥–µ—Ç –≤ spec):**
- [ ] `LSUIElement` = True
- [ ] –í—Å–µ Usage Descriptions –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ entitlements.plist
cat packaging/entitlements.plist
plutil -lint packaging/entitlements.plist

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∫–∏–µ API –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–¥–µ
grep -r "PyAudio" modules/
grep -r "mss.mss" modules/
grep -r "pynput" modules/
grep -r "rumps" modules/
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç `AUDIT_PERMISSIONS.md` —Å –ø–æ–ª–Ω—ã–º —Å–ø–∏—Å–∫–æ–º

---

#### 1.6 –ê—É–¥–∏—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**

1. **–ú–∏–∫—Ä–æ—Ñ–æ–Ω (PyAudio + SpeechRecognition):**
   - [ ] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–∑ –æ—à–∏–±–æ–∫
   - [ ] –î–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ)
   - [ ] –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ
   - [ ] –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ (Google API)

2. **Keyboard monitoring:**
   - [ ] pynput –∏–ª–∏ Quartz —Ä–∞–±–æ—Ç–∞–µ—Ç
   - [ ] –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–∞–∂–∞—Ç–∏—è –ø—Ä–æ–±–µ–ª–∞
   - [ ] –†–∞–∑–ª–∏—á–µ–Ω–∏–µ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ/–¥–ª–∏–Ω–Ω–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è

3. **Menu bar (rumps):**
   - [ ] –ò–∫–æ–Ω–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ menu bar
   - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∏–∫–æ–Ω–æ–∫ (active/off)
   - [ ] –ú–µ–Ω—é —Ä–∞–±–æ—Ç–∞–µ—Ç
   - [ ] LSUIElement —Å–∫—Ä—ã–≤–∞–µ—Ç –∏–∑ Dock

4. **Screenshot (mss):**
   - [ ] –ó–∞—Ö–≤–∞—Ç —ç–∫—Ä–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ)
   - [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤

5. **Audio playback:**
   - [ ] pydub + FFmpeg –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
   - [ ] sounddevice –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
   - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ SwitchAudioSource

6. **gRPC –∫–ª–∏–µ–Ω—Ç:**
   - [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É (production: 20.151.51.172:50051)
   - [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
   - [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤

**–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤:**
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
cat > test_critical_functions.py << 'EOF'
#!/usr/bin/env python3
"""–¢–µ—Å—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø–µ—Ä–µ–¥ —É–ø–∞–∫–æ–≤–∫–æ–π"""

import sys
from pathlib import Path

# –î–æ–±–∞–≤–ª—è–µ–º –ø—É—Ç–∏
CLIENT_ROOT = Path(__file__).parent
sys.path.insert(0, str(CLIENT_ROOT))

def test_imports():
    """–¢–µ—Å—Ç –±–∞–∑–æ–≤—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤"""
    print("üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤...")
    try:
        import rumps
        import speech_recognition
        import PyAudio
        import pydub
        import sounddevice
        import mss
        import grpc
        from modules.grpc_client.proto import streaming_pb2
        print("‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç")
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞: {e}")
        return False

def test_ffmpeg():
    """–¢–µ—Å—Ç FFmpeg"""
    print("\nüîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ FFmpeg...")
    try:
        from pydub import AudioSegment
        import os
        ffmpeg_path = Path("resources/ffmpeg/ffmpeg")
        if ffmpeg_path.exists():
            os.environ["FFMPEG_BINARY"] = str(ffmpeg_path)
            AudioSegment.converter = str(ffmpeg_path)
            print(f"‚úÖ FFmpeg –Ω–∞–π–¥–µ–Ω: {ffmpeg_path}")
            return True
        else:
            print(f"‚ùå FFmpeg –Ω–µ –Ω–∞–π–¥–µ–Ω: {ffmpeg_path}")
            return False
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ FFmpeg: {e}")
        return False

def test_config():
    """–¢–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
    print("\nüîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...")
    try:
        from config.unified_config_loader import UnifiedConfigLoader
        config = UnifiedConfigLoader()
        print("‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
        return True
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: {e}")
        return False

def test_pyobjc():
    """–¢–µ—Å—Ç PyObjC —Ñ–∏–∫—Å–∞"""
    print("\nüîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PyObjC...")
    try:
        import AppKit
        import Foundation
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ NSMakeRect
        if hasattr(Foundation, "NSMakeRect") or hasattr(AppKit, "NSMakeRect"):
            print("‚úÖ PyObjC NSMakeRect –¥–æ—Å—Ç—É–ø–µ–Ω")
            return True
        else:
            print("‚ö†Ô∏è NSMakeRect –Ω–µ –Ω–∞–π–¥–µ–Ω (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞)")
            return False
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ PyObjC: {e}")
        return False

if __name__ == "__main__":
    results = []
    results.append(test_imports())
    results.append(test_ffmpeg())
    results.append(test_config())
    results.append(test_pyobjc())

    print("\n" + "="*50)
    if all(results):
        print("‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´")
        sys.exit(0)
    else:
        print("‚ùå –ù–ï–ö–û–¢–û–†–´–ï –¢–ï–°–¢–´ –ù–ï –ü–†–û–®–õ–ò")
        sys.exit(1)
EOF

chmod +x test_critical_functions.py
python3 test_critical_functions.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç `AUDIT_FUNCTIONS.md` —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç–æ–≤

---

#### 1.7 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
**–¶–µ–ª—å:** –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π workflow —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**–ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **Entry point (main.py):**
   - [ ] PyObjC fix –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –î–û –∏–º–ø–æ—Ä—Ç–∞ rumps
   - [ ] FFmpeg –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –î–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è pydub
   - [ ] Event loop –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è
   - [ ] SimpleModuleCoordinator –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

2. **SimpleModuleCoordinator:**
   - [ ] –í—Å–µ integration –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
   - [ ] –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–æ priority)
   - [ ] EventBus —Ä–∞–±–æ—Ç–∞–µ—Ç
   - [ ] StateManager —Ä–∞–±–æ—Ç–∞–µ—Ç

3. **Event Bus:**
   - [ ] –°–æ–±—ã—Ç–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
   - [ ] –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
   - [ ] –ù–µ—Ç deadlocks

4. **Workflows:**
   - [ ] ListeningWorkflow (SLEEPING ‚Üí LISTENING)
   - [ ] ProcessingWorkflow (LISTENING ‚Üí PROCESSING ‚Üí SLEEPING)
   - [ ] –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ dev —Ä–µ–∂–∏–º–µ
python3 main.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
tail -f logs/nexy.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ menu bar –ø–æ—è–≤–∏–ª—Å—è
# (–≤–∏–∑—É–∞–ª—å–Ω–æ - –∏–∫–æ–Ω–∫–∞ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–∫—É–º–µ–Ω—Ç `AUDIT_WORKFLOW.md` —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º flow

---

### **–≠–¢–ê–ü 2: –°–û–ó–î–ê–ù–ò–ï SPEC –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú** ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–Å–ù 2025-10-10
**–û—Ç—á—ë—Ç—ã:**
- [docs/packaging/02_SPEC_CREATION.md](docs/packaging/02_SPEC_CREATION.md)
- [docs/packaging/04_FLAC_UPGRADE.md](docs/packaging/04_FLAC_UPGRADE.md)

**–ü—Ä–æ–±–ª–µ–º—ã –≤—ã—è–≤–ª–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**

1. **‚ùå ‚Üí ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç Nexy.spec:**
   - –°–æ–∑–¥–∞–Ω packaging/Nexy.spec —Å –Ω—É–ª—è
   - Entry point: main.py
   - 50+ hiddenimports (gRPC, PyObjC, rumps, pynput, –≤—Å–µ –º–æ–¥—É–ª–∏)
   - Binaries: FFmpeg, SwitchAudioSource, FLAC
   - Data files: config, assets, resources
   - Info.plist —Å LSUIElement = True –∏ –≤—Å–µ–º–∏ Usage Descriptions

2. **‚ùå ‚Üí ‚úÖ FLAC —É—Å—Ç–∞—Ä–µ–≤—à–∏–π:**
   - –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω FLAC 1.5.0 arm64 –≤ resources/audio/flac
   - –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä –≤ spec –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Å—Ç–∞—Ä–æ–≥–æ flac-mac

3. **‚ùå ‚Üí ‚úÖ numpy –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ:**
   - –ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞: `ModuleNotFoundError: No module named 'numpy'`
   - –£–¥–∞–ª—ë–Ω numpy –∏–∑ excludes (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 11 —Ñ–∞–π–ª–∞—Ö)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** PyInstaller spec –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤

---

### **–≠–¢–ê–ü 3: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–£–¢–ï–ô** ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–Å–ù 2025-10-10
**–û—Ç—á—ë—Ç—ã:**
- [docs/packaging/05_PATH_STRUCTURE_ANALYSIS.md](docs/packaging/05_PATH_STRUCTURE_ANALYSIS.md)
- [docs/packaging/06_PATH_FIXES_STATUS.md](docs/packaging/06_PATH_FIXES_STATUS.md)

**–ö—Ä–∏—Ç–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞:**
- –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ —Ç–∏–ø–∞ `config/unified_config.yaml` —Ä–∞–±–æ—Ç–∞—é—Ç –≤ dev —Ä–µ–∂–∏–º–µ
- –ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ /Applications/Nexy.app/
- CWD –≤ dev: /Users/.../Nexy/client/
- CWD –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏: /Applications/Nexy.app/Contents/MacOS/

**–†–µ—à–µ–Ω–∏–µ:**

1. **–°–æ–∑–¥–∞–Ω integration/utils/resource_path.py:**
   - `get_resource_path()` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–µ–∑–æ–ª–≤–µ—Ä (dev/onefile/bundle)
   - `get_user_data_dir()` - ~/Library/Application Support/Nexy/
   - `get_user_cache_dir()`, `get_user_logs_dir()`

2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 7 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:**
   - config/updater_manager.py
   - config/server_manager.py
   - modules/grpc_client/core/grpc_client.py
   - modules/permissions/core/config.py
   - modules/tray_controller/core/config.py
   - modules/screenshot_capture/core/config.py
   - modules/hardware_id/core/config.py

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

---

### **–≠–¢–ê–ü 4: –¢–ï–°–¢–û–í–ê–Ø –°–ë–û–†–ö–ê** ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–Å–ù 2025-10-10
**–û—Ç—á—ë—Ç:** [docs/packaging/07_BUILD_AND_SMOKE_TESTS.md](docs/packaging/07_BUILD_AND_SMOKE_TESTS.md)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ spec —Ñ–∞–π–ª–∞:**

1. **Paths** - –ø—É—Ç–∏ –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º
2. **Data files** - –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã (config, assets, resources)
3. **Binaries** - –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã (FFmpeg, SwitchAudioSource, FLAC)
4. **Hidden imports** - –≤—Å–µ –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
5. **Excludes** - –Ω–µ–Ω—É–∂–Ω—ã–µ –º–æ–¥—É–ª–∏
6. **Analysis** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–∞–ª–∏–∑–∞
7. **EXE** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ executable
8. **COLLECT** - —Å–±–æ—Ä–∫–∞ –≤ onedir
9. **BUNDLE** - —Å–æ–∑–¥–∞–Ω–∏–µ .app —Å Info.plist

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ Info.plist:**
```python
info_plist={
    'LSUIElement': True,
    'NSMicrophoneUsageDescription': '...',
    'NSScreenCaptureUsageDescription': '...',
    'NSAppleEventsUsageDescription': '...',
    'NSInputMonitoringUsageDescription': '...',
    'CFBundleShortVersionString': '1.71.0',
    'CFBundleVersion': '1.71.0',
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –§–∞–π–ª `Nexy.spec` –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

---

### **–≠–¢–ê–ü 4: –¢–ï–°–¢–û–í–ê–Ø –°–ë–û–†–ö–ê** üß™

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**
```bash
source .venv/bin/activate
pyinstaller packaging/Nexy.spec --clean --noconfirm
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ Nexy.app —Å–æ–∑–¥–∞–Ω
- ‚úÖ –†–∞–∑–º–µ—Ä: ~200MB (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã)
- ‚úÖ –í—Å–µ —Ä–µ—Å—É—Ä—Å—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ Python.framework —É–¥–∞–ª—ë–Ω (–∏–∑–±—ã—Ç–æ—á–Ω—ã–π)
- ‚úÖ Info.plist –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π

**Smoke-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- ‚úÖ –ö–æ–Ω—Ñ–∏–≥–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ö†Ô∏è –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
  - nexy.lock infinite loop (log spam, –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É)
  - google.protobuf.service warning (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º–æ)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** .app bundle –≥–æ—Ç–æ–≤ –∫ –ø–æ–¥–ø–∏—Å–∏

---

### **–≠–¢–ê–ü 5: CODE SIGNING & NOTARIZATION** ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–Å–ù 2025-10-10
**–û—Ç—á—ë—Ç:** [docs/packaging/08_SIGNING_AND_NOTARIZATION.md](docs/packaging/08_SIGNING_AND_NOTARIZATION.md)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Developer ID Application —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç: `Developer ID Application: Sergiy Zasorin (5NKLL2CLB9)`
- Developer ID Installer —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç: `Developer ID Installer: Sergiy Zasorin (5NKLL2CLB9)`

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ build_final.sh:**

1. **Code signing:**
   - ‚úÖ –ü–æ–¥–ø–∏—Å–∞–Ω—ã –≤–ª–æ–∂–µ–Ω–Ω—ã–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ (FFmpeg, SwitchAudioSource)
   - ‚úÖ –ü–æ–¥–ø–∏—Å–∞–Ω –≥–ª–∞–≤–Ω—ã–π executable —Å entitlements
   - ‚úÖ –ü–æ–¥–ø–∏—Å–∞–Ω bundle
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞: `codesign --verify --deep --strict` –ø—Ä–æ–π–¥–µ–Ω–∞

2. **Notarization:**
   ```bash
   ditto -c -k --noextattr --noqtn /tmp/Nexy.app Nexy-app-for-notarization.zip
   xcrun notarytool submit Nexy-app-for-notarization.zip \
     --keychain-profile "nexy-notary" --wait
   ```
   - ‚úÖ –°—Ç–∞—Ç—É—Å: Accepted

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ –∏ –Ω–æ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω–æ

---

### **–≠–¢–ê–ü 6: –°–û–ó–î–ê–ù–ò–ï PKG & DMG** ‚úÖ

**–°—Ç–∞—Ç—É—Å:** –ó–ê–í–ï–†–®–Å–ù 2025-10-10
**–û—Ç—á—ë—Ç:** [docs/packaging/09_FINAL_RELEASE.md](docs/packaging/09_FINAL_RELEASE.md)

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ:**

1. **DMG —Å–æ–∑–¥–∞–Ω–∏–µ:**
   ```bash
   hdiutil create -volname "Nexy" -srcfolder /tmp/Nexy.app dist/Nexy-temp.dmg
   # –î–æ–±–∞–≤–ª–µ–Ω —Å–∏–º–ª–∏–Ω–∫ –Ω–∞ /Applications
   hdiutil convert dist/Nexy-temp.dmg -format UDZO -o dist/Nexy.dmg
   ```
   - ‚úÖ DMG —Å–æ–∑–¥–∞–Ω (93 MB)
   - ‚úÖ –ù–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏—è: Accepted
   - ‚úÖ Stapling: —É—Å–ø–µ—à–Ω–æ

2. **PKG —Å–æ–∑–¥–∞–Ω–∏–µ:**
   ```bash
   pkgbuild --root /tmp/nexy_pkg_clean_final dist/Nexy-raw.pkg
   productbuild --distribution packaging/distribution.xml dist/Nexy-distribution.pkg
   productsign --sign "Developer ID Installer" dist/Nexy.pkg
   ```
   - ‚úÖ PKG —Å–æ–∑–¥–∞–Ω (93 MB)
   - ‚úÖ –ù–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏—è: Accepted
   - ‚úÖ Stapling: —É—Å–ø–µ—à–Ω–æ

3. **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
   - ‚úÖ `codesign --verify --deep --strict dist/Nexy.app`
   - ‚úÖ `pkgutil --check-signature dist/Nexy.pkg`
   - ‚úÖ `xcrun stapler validate dist/Nexy.dmg`
   - ‚úÖ `xcrun stapler validate dist/Nexy.pkg`
   - ‚úÖ `spctl --assess` –ø—Ä–æ–π–¥–µ–Ω –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ã –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é

---

## üìä –ß–ï–ö–õ–ò–°–¢ –ì–û–¢–û–í–ù–û–°–¢–ò

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —É–ø–∞–∫–æ–≤–∫–∏:
- ‚úÖ –í—Å–µ –∞—É–¥–∏—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- ‚úÖ Nexy.spec —Å–æ–∑–¥–∞–Ω –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω
- ‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è —Å–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–∞
- ‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã

### –ü–µ—Ä–µ–¥ –ø–æ–¥–ø–∏—Å—å—é:
- ‚úÖ –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã
- ‚úÖ entitlements.plist –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- ‚úÖ Info.plist –ø–æ–ª–Ω—ã–π

### –ü–µ—Ä–µ–¥ –Ω–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏–µ–π:
- ‚úÖ –ü–æ–¥–ø–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
- ‚úÖ Extended attributes –æ—á–∏—â–µ–Ω—ã
- ‚úÖ Keychain profile –Ω–∞—Å—Ç—Ä–æ–µ–Ω

### –ü–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º:
- ‚úÖ PKG/DMG –Ω–æ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω—ã
- ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- ‚úÖ Release notes –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã

---

## üéØ –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

### ‚úÖ –í–°–ï –ö–†–ò–¢–ï–†–ò–ò –í–´–ü–û–õ–ù–ï–ù–´!

1. ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ —á–∏—Å—Ç–æ–π macOS –±–µ–∑ dev-–æ–∫—Ä—É–∂–µ–Ω–∏—è
2. ‚úÖ –ò–∫–æ–Ω–∫–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ menu bar
3. ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (–º–∏–∫—Ä–æ—Ñ–æ–Ω, –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞, —Å–∫—Ä–∏–Ω—à–æ—Ç—ã, –∑–≤—É–∫)
4. ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç—Å—è
5. ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É —Ä–∞–±–æ—Ç–∞–µ—Ç
6. ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∫—Ä–∞—à–µ–π –∏ –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
7. ‚úÖ PKG/DMG –ø–æ–¥–ø–∏—Å–∞–Ω—ã –∏ –Ω–æ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω—ã
8. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
9. ‚úÖ –†–∞–∑–º–µ—Ä —Ä–∞–∑—É–º–Ω—ã–π (200MB app, 93MB pkg/dmg)
10. ‚úÖ –ó–∞–ø—É—Å–∫ –±—ã—Å—Ç—Ä—ã–π (<5 —Å–µ–∫—É–Ω–¥)

---

## üìö –£–†–û–ö–ò –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏:

1. **Missing spec file** - –∫—Ä–∏—Ç–∏—á–Ω—ã–π –±–ª–æ–∫–µ—Ä
   - –†–µ—à–µ–Ω–∏–µ: –°–æ–∑–¥–∞–Ω comprehensive spec —Å 50+ hiddenimports

2. **Resource paths** - –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
   - –†–µ—à–µ–Ω–∏–µ: resource_path.py –¥–ª—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

3. **FLAC outdated** - x86_64 SDK 10.6
   - –†–µ—à–µ–Ω–∏–µ: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ arm64 1.5.0

4. **numpy in excludes** - –æ—à–∏–±–æ—á–Ω–æ –∏—Å–∫–ª—é—á—ë–Ω
   - –†–µ—à–µ–Ω–∏–µ: –£–¥–∞–ª—ë–Ω –∏–∑ excludes (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 11 —Ñ–∞–π–ª–∞—Ö)

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–µ–ª–∏–∑–æ–≤:

1. **–ü–µ—Ä–µ–¥ —É–ø–∞–∫–æ–≤–∫–æ–π:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å spec —Ñ–∞–π–ª –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å
   - –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ unified_config.yaml
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ –Ω–∞ arm64

2. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π:**
   - –î–æ–±–∞–≤–∏—Ç—å –≤ hiddenimports –≤ spec
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å get_resource_path() –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
   - –ò–∑–±–µ–≥–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—É—Ç–µ–π

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —á–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º–µ
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ /Applications/
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è macOS

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–ò

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã:

```
/Users/sergiyzasorin/Development/Nexy/client/
‚îú‚îÄ‚îÄ PACKAGING_MASTER_PLAN.md (—ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç)
‚îú‚îÄ‚îÄ Nexy.spec (spec —Ñ–∞–π–ª –¥–ª—è PyInstaller)
‚îú‚îÄ‚îÄ docs/packaging/
‚îÇ   ‚îú‚îÄ‚îÄ AUDIT_BINARIES.md
‚îÇ   ‚îú‚îÄ‚îÄ AUDIT_DEPENDENCIES.md
‚îÇ   ‚îú‚îÄ‚îÄ AUDIT_MODULES.md
‚îÇ   ‚îú‚îÄ‚îÄ AUDIT_RESOURCES.md
‚îÇ   ‚îú‚îÄ‚îÄ AUDIT_PERMISSIONS.md
‚îÇ   ‚îú‚îÄ‚îÄ AUDIT_FUNCTIONS.md
‚îÇ   ‚îú‚îÄ‚îÄ AUDIT_WORKFLOW.md
‚îÇ   ‚îú‚îÄ‚îÄ ISSUES_FIXED.md
‚îÇ   ‚îú‚îÄ‚îÄ BUILD_TEST_REPORT.md
‚îÇ   ‚îú‚îÄ‚îÄ FUNCTIONAL_TEST_REPORT.md
‚îÇ   ‚îî‚îÄ‚îÄ FINAL_TEST_REPORT.md
```

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

**–£–ü–ê–ö–û–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!** üéâ

**–î–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Ä–µ–ª–∏–∑–æ–≤:**
1. –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ [config/unified_config.yaml](config/unified_config.yaml)
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `./packaging/build_final.sh`
3. –ê—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –±—É–¥—É—Ç –≤ `dist/` (Nexy.app, Nexy.dmg, Nexy.pkg)

**–ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å
codesign --verify --deep --strict dist/Nexy.app

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ—Ç–∞—Ä–∏–∑–∞—Ü–∏—é
xcrun stapler validate dist/Nexy.dmg
xcrun stapler validate dist/Nexy.pkg

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
open dist/Nexy.dmg  # –∏–ª–∏
sudo installer -pkg dist/Nexy.pkg -target /
```

---

**–í–µ—Ä—Å–∏—è –ø–ª–∞–Ω–∞:** 2.0 (–ó–ê–í–ï–†–®–Å–ù)
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-10-09
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-10-10
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –≠–¢–ê–ü–´ –í–´–ü–û–õ–ù–ï–ù–´ –£–°–ü–ï–®–ù–û
