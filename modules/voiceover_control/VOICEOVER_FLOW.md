# VoiceOver Control - –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

## üîÑ –ö–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ/–≤–∫–ª—é—á–µ–Ω–∏–µ VoiceOver

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ —Ä–µ–∂–∏–º–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

VoiceOver –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–µ–∂–∏–º–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ EventBus:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –ø—Ä–æ–±–µ–ª ‚Üí –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ —Ä–µ–∂–∏–º LISTENING
                                    ‚Üì
                            EventBus –ø—É–±–ª–∏–∫—É–µ—Ç app.mode_changed
                                    ‚Üì
                    VoiceOverDuckingIntegration.handle_mode_change()
                                    ‚Üì
                        controller.apply_mode("listening")
                                    ‚Üì
                    –ü—Ä–æ–≤–µ—Ä–∫–∞: "listening" –≤ duck_on_modes?
                                    ‚Üì
                                –î–ê ‚Üí controller.duck()
                                    ‚Üì
                            Command+F5 ‚Üí VoiceOver –û–¢–ö–õ–Æ–ß–ê–ï–¢–°–Ø
```

### 2. **–¢–æ—á–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è**

#### üé§ **–û–¢–ö–õ–Æ–ß–ï–ù–ò–ï VoiceOver (Ducking):**
- **–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Ä–µ–∂–∏–º `LISTENING`** (–¥–æ–ª–≥–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –ø—Ä–æ–±–µ–ª–∞)
- **–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Ä–µ–∂–∏–º `PROCESSING`** (–æ—Ç–ø—É—Å–∫–∞–Ω–∏–µ –ø—Ä–æ–±–µ–ª–∞)
- **–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏** (–µ—Å–ª–∏ `engage_on_keyboard_press: true`)

#### üîÑ **–í–ö–õ–Æ–ß–ï–ù–ò–ï VoiceOver (Release):**
- **–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Ä–µ–∂–∏–º `SLEEPING`** (–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
- **–ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** (`app.shutdown`)

### 3. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π**

```
1. SLEEPING (VoiceOver –≤–∫–ª—é—á–µ–Ω, _ducked = false)
   ‚Üì –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∏ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–±–µ–ª
2. LISTENING (VoiceOver –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è) ‚Üê Command+F5, _ducked = true
   ‚Üì –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–±–µ–ª
3. PROCESSING (VoiceOver –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º, _ducked = true)
   ‚Üì –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
4. SLEEPING (VoiceOver –≤–∫–ª—é—á–∞–µ—Ç—Å—è) ‚Üê Command+F5, _ducked = false
```

### 4. **–£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è**

**–ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º VoiceOver –ø–æ—Å—Ç–æ—è–Ω–Ω–æ!**

- **LISTENING**: –û—Ç–∫–ª—é—á–∞–µ–º VoiceOver —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –µ—â–µ –Ω–µ –æ—Ç–∫–ª—é—á–µ–Ω (`_ducked = false`)
- **PROCESSING**: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –µ—Å–ª–∏ —É–∂–µ –æ—Ç–∫–ª—é—á–µ–Ω, –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
- **SLEEPING**: –í–∫–ª—é—á–∞–µ–º VoiceOver —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–Ω –±—ã–ª –æ—Ç–∫–ª—é—á–µ–Ω –Ω–∞–º–∏ (`_ducked = true`)

### 5. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–µ–∂–∏–º–æ–≤**

–í `unified_config.yaml`:
```yaml
voiceover_control:
  duck_on_modes:      # –ö–æ–≥–¥–∞ –û–¢–ö–õ–Æ–ß–ê–¢–¨ VoiceOver
    - listening
    - processing
  release_on_modes:   # –ö–æ–≥–¥–∞ –í–ö–õ–Æ–ß–ê–¢–¨ VoiceOver
    - sleeping
```

### 6. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã**

#### –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏:
```python
# –ï—Å–ª–∏ engage_on_keyboard_press: true
async def handle_keyboard_press(self, event):
    await self.controller.duck(reason="keyboard.press")
```

#### –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã:
```python
async def handle_shutdown(self, event):
    await self.controller.shutdown()  # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç VoiceOver
```

## üìä –õ–æ–≥–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ VoiceOver:
```
INFO - VoiceOverController: Ducking VoiceOver for mode listening
INFO - VoiceOverController: Using Command+F5 to disable VoiceOver (reason=mode:listening)
INFO - VoiceOverController: Command+F5 executed successfully
```

### –ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ VoiceOver:
```
INFO - VoiceOverController: Releasing VoiceOver for mode sleeping
INFO - VoiceOverController: VoiceOver restored via Command+F5
```

### –ö–æ–≥–¥–∞ VoiceOver —É–∂–µ –≤ –Ω—É–∂–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏:
```
DEBUG - VoiceOverController: VoiceOver already ducked, staying in mode processing
DEBUG - VoiceOverController: VoiceOver not ducked, staying in mode sleeping
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è

### –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```yaml
voiceover_control:
  enabled: true                    # –í–∫–ª—é—á–∏—Ç—å –º–æ–¥—É–ª—å
  engage_on_keyboard_press: true   # Ducking –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–ª–∞–≤–∏—à–∏
  debounce_seconds: 0.25          # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
  debug_logging: true             # –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä

### –°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å VoiceOver** –∑–∞–ø—É—Å–∫–∞–µ—Ç Nexy
2. **VoiceOver –≤–∫–ª—é—á–µ–Ω** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ª—ã—à–∏—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
3. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –ø—Ä–æ–±–µ–ª** - –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å
4. **VoiceOver –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è** - –Ω–µ—Ç –ø–æ–º–µ—Ö –¥–ª—è –∑–∞–ø–∏—Å–∏
5. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–±–µ–ª** - –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
6. **VoiceOver –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º** - –Ω–µ—Ç –ø–æ–º–µ—Ö –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
7. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞** - VoiceOver –≤–∫–ª—é—á–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ
8. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–Ω–æ–≤–∞ —Å–ª—ã—à–∏—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç:
```bash
# –í –ª–æ–≥–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–∫–∞—Ç—å:
grep "VoiceOverDuckingIntegration" logs/app.log
grep "Command+F5" logs/app.log
grep "mode:listening" logs/app.log
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è:
```bash
grep "app.mode_changed" logs/app.log
grep "keyboard.press" logs/app.log
```

---

## üéâ **–ò—Ç–æ–≥**

**VoiceOver —É–º–Ω–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–µ–∂–∏–º–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**

- **LISTENING** ‚Üí VoiceOver –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –æ—Ç–∫–ª—é—á–µ–Ω)
- **PROCESSING** ‚Üí VoiceOver –æ—Å—Ç–∞–µ—Ç—Å—è –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–º (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è)
- **SLEEPING** ‚Üí VoiceOver –≤–∫–ª—é—á–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –±—ã–ª –æ—Ç–∫–ª—é—á–µ–Ω –Ω–∞–º–∏)

**–£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ª–∏—à–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è VoiceOver!**

**–í—Å–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ EventBus –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞!**
